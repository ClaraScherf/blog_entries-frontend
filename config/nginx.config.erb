worker_processes 1;
daemon off;

error_log <%= ENV["APP_ROOT"] %>/nginx/error.log;

events {
  worker_connections 1024;
}

http {
  include mime.types;
  default_type application/octet-stream;
  sendfile on;

  gzip on;
  gzip_http_version 1.0;
  gzip_proxied any;
  gzip_min_length 500;
  gzip_disable "MSIE [1-6]\.";
  gzip_types text/plain text/xml text/css
             text/comma-separated-values
             text/javascript
             application/x-javascript
             application/atom+xml;

  server {
    listen <%= ENV["PORT"] %>;
    server_name localhost;

    location / {
      root <%= ENV["APP_ROOT"] %>/dist;
      index index.html index.htm;
      try_files $uri $uri/ /index.html;
    }

    location @app {
      proxy_pass http://localhost:1024;
    }
  }
}
